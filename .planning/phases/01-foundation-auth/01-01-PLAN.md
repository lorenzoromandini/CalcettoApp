---
phase: 01-foundation-auth
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - next.config.ts
  - package.json
  - .env.local
  - tsconfig.json
  - app/layout.tsx
  - app/globals.css
  - components/ui/button.tsx
  - components/ui/input.tsx
  - components/ui/card.tsx
  - components/ui/label.tsx
  - components/ui/form.tsx
  - lib/utils.ts
autonomous: true
user_setup:
  - service: supabase
    why: "Authentication and database hosting"
    env_vars:
      - name: NEXT_PUBLIC_SUPABASE_URL
        source: "Supabase Dashboard -> Project Settings -> API -> URL"
      - name: NEXT_PUBLIC_SUPABASE_ANON_KEY
        source: "Supabase Dashboard -> Project Settings -> API -> anon public"
      - name: SUPABASE_SERVICE_ROLE_KEY
        source: "Supabase Dashboard -> Project Settings -> API -> service_role (keep secret)"
    dashboard_config:
      - task: "Enable Google OAuth provider"
        location: "Authentication -> Providers -> Google -> Enable"
      - task: "Configure OAuth callback URL"
        location: "Add https://yourdomain.com/auth/callback to Google OAuth settings"

must_haves:
  truths:
    - "Next.js 15 project initialized with shadcn/ui"
    - "Supabase dependencies installed"
    - "Project structure follows research recommendations"
  artifacts:
    - path: "package.json"
      provides: "All required dependencies installed"
      contains: "@supabase/supabase-js, @supabase/ssr, next-themes, next-intl, idb, workbox-cli"
    - path: ".env.local"
      provides: "Supabase credentials configured"
      contains: "NEXT_PUBLIC_SUPABASE_URL, NEXT_PUBLIC_SUPABASE_ANON_KEY"
    - path: "tsconfig.json"
      provides: "TypeScript paths configured"
      contains: "@/* path alias to src/* or ./*"
  key_links:
    - from: "tsconfig.json"
      to: "lib/"
      via: "path aliases"
      pattern: '"@/*": ["./*"]'
---

<objective>
Initialize the Calcetto Manager Next.js 15 project with all required dependencies and shadcn/ui component foundation.

Purpose: This plan establishes the codebase foundation with the confirmed tech stack (React 19 + Next.js 15 + Supabase + Tailwind + shadcn/ui). All subsequent plans depend on this infrastructure being in place.

Output: Fully initialized Next.js project with shadcn/ui, all dependencies installed, and basic project structure ready for authentication and offline features.
</objective>

<execution_context>
@/home/ubuntu/.config/opencode/get-shit-done/workflows/execute-plan.md
@/home/ubuntu/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-auth/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize Next.js 15 Project with shadcn/ui</name>
  <files>
    - package.json
    - next.config.ts
    - tsconfig.json
    - tailwind.config.ts
    - app/layout.tsx
    - app/globals.css
    - components/ui/
    - lib/utils.ts
  </files>
  <action>
    Initialize a new Next.js 15 project with shadcn/ui using the shadcn CLI. Use the neutral base color (not zinc/slate/stone) as it's most appropriate for a sports app. Install with TypeScript, ESLint, and Tailwind CSS.

    Steps:
    1. Run `npx shadcn@latest init --yes --template next --base-color neutral` (use defaults, not --yes if prompts for options)
    2. If the directory already has files, handle gracefully - the project may be partially initialized
    3. Verify the project structure matches RESEARCH.md recommendations
    4. Install the following shadcn/ui components immediately: button, input, card, label, form

    IMPORTANT: This is a Next.js 15 project with App Router. Ensure all files follow App Router conventions (app/ directory, not pages/).
  </action>
  <verify>
    - `npm run build` completes without errors
    - `ls app/` shows layout.tsx and page.tsx exist
    - `ls components/ui/` shows button.tsx exists
    - `cat package.json | grep next` shows version 15.x
  </verify>
  <done>
    Next.js 15 project initialized with shadcn/ui, TypeScript configured, and base components (button, input, card, label, form) installed
  </done>
</task>

<task type="auto">
  <name>Task 2: Install Phase 1 Dependencies</name>
  <files>
    - package.json
    - package-lock.json
  </files>
  <action>
    Install all required dependencies for Phase 1 based on RESEARCH.md findings:

    Core dependencies:
    - @supabase/supabase-js (Supabase client)
    - @supabase/ssr (SSR/Server Components auth)
    - idb (IndexedDB wrapper - lightweight at ~1.19kB)
    - next-themes (dark/light mode)
    - next-intl (i18n for Italian/English)
    - lucide-react (icons - already installed by shadcn)

    Dev dependencies:
    - workbox-cli (Service Worker build tool)
    - workbox-build (SW generation)

    Run npm install with all packages at once. Verify package.json reflects all installations.

    NOTE: Do NOT install next-pwa (deprecated per RESEARCH.md). We'll use Next.js built-in PWA support + Workbox directly.
  </action>
  <verify>
    - `npm list @supabase/supabase-js` shows installed
    - `npm list @supabase/ssr` shows installed
    - `npm list idb` shows installed
    - `npm list next-themes` shows installed
    - `npm list next-intl` shows installed
    - `npm list --save-dev workbox-cli` shows installed
    - `npm run build` still works
  </verify>
  <done>
    All Phase 1 dependencies installed: Supabase auth, idb, next-themes, next-intl, and Workbox build tools
  </done>
</task>

<task type="auto">
  <name>Task 3: Configure Environment and Project Structure</name>
  <files>
    - .env.local
    - .env.example
    - .gitignore
    - lib/supabase/
    - lib/db/
    - lib/i18n/
    - messages/
    - public/icons/
    - app/[locale]/
  </files>
  <action>
    Set up environment configuration and project directory structure per RESEARCH.md recommendations:

    1. Create .env.local template with placeholder Supabase credentials:
       - NEXT_PUBLIC_SUPABASE_URL=
       - NEXT_PUBLIC_SUPABASE_ANON_KEY=
       - SUPABASE_SERVICE_ROLE_KEY= (for admin operations)

    2. Create .env.example as a template for developers

    3. Update .gitignore to exclude .env.local (should already be done by shadcn init, verify)

    4. Create directory structure:
       - lib/supabase/ (for auth clients)
       - lib/db/ (for IndexedDB operations)
       - lib/i18n/ (for next-intl config)
       - messages/ (for translation files)
       - public/icons/ (for PWA icons)
       - app/[locale]/ (i18n routing - create with empty layout.tsx placeholder)

    5. Create empty placeholder files to establish structure:
       - lib/supabase/.gitkeep
       - lib/db/.gitkeep
       - messages/en.json (empty object {})
       - messages/it.json (empty object {})

    The app/[locale]/ structure prepares for next-intl routing while keeping existing app/ files functional during migration.
  </action>
  <verify>
    - `cat .env.local` shows placeholder variables
    - `ls lib/supabase/` exists
    - `ls lib/db/` exists
    - `ls lib/i18n/` exists
    - `ls messages/` contains en.json and it.json
    - `ls public/icons/` exists
    - `ls app/[locale]/` exists
  </verify>
  <done>
    Environment template created, .gitignore configured, and full project directory structure established per RESEARCH.md architecture
  </done>
</task>

</tasks>

<verification>
After this plan completes:
1. `npm run dev` starts the development server successfully
2. Project structure matches RESEARCH.md recommendations
3. All dependencies are installed and importable
4. shadcn/ui components render correctly
5. Environment variables are configured (values to be filled by user)
</verification>

<success_criteria>
- Next.js 15 project initialized with App Router
- shadcn/ui components (button, input, card, label, form) installed and functional
- All Phase 1 dependencies installed (@supabase/*, idb, next-themes, next-intl, workbox-cli)
- Directory structure created: lib/supabase/, lib/db/, lib/i18n/, messages/, public/icons/
- .env.local template with Supabase placeholders
- Build completes without errors
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-auth/01-foundation-auth-01-SUMMARY.md` documenting:
- Project initialization details
- Installed dependencies with versions
- Directory structure created
- Next steps for user (fill in Supabase credentials)
</output>
